import{o as e,e as t,f as i,i as n,x as a,t as l,a as r,g as o,n as s,y as u,z as c,l as d,h as v,F as p,m as h}from"./vendor.js";import{r as f,A as g}from"./root.js";const m={name:"FilterItem",props:{value:{type:String,required:!0},text:{type:String,required:!0},name:{type:String,required:!0},checked:{type:Boolean,required:!0},handleChange:{type:Function,required:!0}},computed:{id:function(){return`filter-id-${this.value}-${Date.now()*Math.random()}`}},methods:{onChange(e){const{currentTarget:t}=e;t.checked&&this.handleChange(t.value)}}},k={class:"filter__radio-wrapper"};function y(e,t){const i=a({widthShrink:0,widthExpand:0,posLeft:0,duration:.3}),n=a(!1),s=a(!1),u=a(),c=(t=!1)=>{e.value&&(0===i.value.widthExpand||t)&&(i.value.widthExpand=e.value.offsetWidth+10)},d=(e=!1)=>{t.value&&(e?o.set(t.value,{width:i.value.widthExpand}):(o.set(t.value,{clearProps:"width"}),setTimeout((()=>{c(),o.timeline().set(t.value,{width:i.value.widthExpand}).to(t.value,{background:"#131313",duration:i.value.duration})}),100)))},v=()=>{t.value&&(o.to(t.value,{background:"transparent",duration:i.value.duration}),n.value&&setTimeout((()=>{t.value&&0===i.value.widthShrink&&(i.value.widthShrink=+getComputedStyle(t.value).getPropertyValue("--width-shrink")),o.set(t.value,{width:i.value.widthShrink})}),500))},p=(e=!1)=>{t.value&&(e?o.set(t.value,{x:i.value.posLeft}):o.to(t.value,{x:i.value.posLeft,duration:i.value.duration}))},h=l((()=>{s.value=!s.value,s.value?d():v()}),600);return{root:e,pinContainer:t,btnToggle:u,isActive:s,isPinned:n,scrollPin:()=>{t.value&&r.create({trigger:t.value,start:"top 90",end:99999,pin:!0,pinSpacing:!1,onToggle:({isActive:e})=>{if(e)n.value=!0,p(),v();else{let e=s.value;u.value&&u.value.blur(),n.value=!1,s.value=!1,((e=!0)=>{t.value&&o.to(t.value,{x:0,background:"transparent",duration:i.value.duration,onStart:()=>{e&&o.set(t.value,{clearProps:"width"})}})})(!e)}},onRefresh:({isActive:e})=>{t.value&&(i.value.posLeft=-1*t.value.getBoundingClientRect().left),e&&p(!0),s.value&&(c(!0),d(!0)),e&&!s.value&&v()}})},handleClickOutside:e=>{!e.target.closest("div.filter")&&(s.value=!1,v())},throttleClick:h}}m.render=function(a,l,r,o,s,u){return e(),t("div",k,[i("input",{onChange:l[1]||(l[1]=(...e)=>u.onChange&&u.onChange(...e)),id:u.id,value:r.value,checked:r.checked,type:"radio",name:r.name,class:"filter__radio"},null,40,["id","value","checked","name"]),i("label",{for:u.id,class:"filter__item"},n(r.text),9,["for"])])};const b=e=>{const t={padding:e.padding?e.padding:"1em",color:e.color?e.color:"inherit",background:e.background?e.background:"inherit","font-size":e.fontSize?e.fontSize:"inherit","font-weight":e.fontWeight?e.fontWeight:"inherit"};return i=t,Object.entries(i).map((([e,t])=>`${e}: ${t}`)).join("; ");var i},w=(e,t)=>{console.log("%c%s",t,e)};function C(e,t,i){const n=document.querySelector(".page-header-pin");return{scrollPinMobile:()=>{if(!t.value||!n||!i.value)return void((e,t="default")=>{switch(t){case"error":w(e,b({background:"indianred"}));break;case"warn":w(e,b({background:"chocolate"}));break;default:w(e,b({background:"cornflowerblue"}))}})("scrollPinMobile -> missed required elms","error");(()=>{if(e.value){const t=-n.offsetHeight;o.set(n,{y:t});const a=.5;let l=!1,s=document.documentElement.clientHeight+200;f(document.documentElement,(()=>{s=document.documentElement.clientHeight+200}));const u=o.timeline({onStart(){l=!0},paused:!0}).to(n,{y:0,duration:a},"one").to(e.value,{y:n.offsetHeight,duration:a},"one"),c=o.timeline({onComplete(){l=!1},paused:!0}).to(n,{y:t,duration:a},"one").to(e.value,{y:0,duration:a},"one"),d=()=>{l=!1,o.set(n,{y:t}),o.set(e.value,{y:0})};let v=()=>u.isActive()||c.isActive(),p=!1;r.create({trigger:document.documentElement,end:()=>`${i.value.offsetHeight} top`,onUpdate({direction:e}){const t=document.documentElement.scrollTop>=s;0!==document.documentElement.scrollTop?(setTimeout((()=>{p=-1===e}),100),v()||(p&&t?l||u.restart():l&&c.restart())):d()}})}})(),(()=>{if(e.value&&t.value){let n=e.value.scrollLeft;e.value.addEventListener("scroll",l((()=>{n=e.value.scrollLeft}),200),{passive:!0}),r.create({id:"filter-pin",trigger:t.value,start:"top top",end:()=>`${i.value.offsetHeight-(window.screen.height-10*t.value.offsetHeight)} top`,pin:!0,pinSpacing:!1,onRefresh(){e.value.scrollLeft=n}})}})()}}}var S=s({name:"FilterElm",components:{FilterItem:m},props:{filterItems:{type:Array,required:!0},setActiveFilter:{type:Function,required:!0},filterName:{type:String,default:"filter"},isStatic:{type:Boolean,default:!1},staticElms:{type:Object},contentList:{type:Object,required:!0}},setup(e){const t=e.isStatic,i=a(),n=a(),l=u((()=>e.contentList)),s=u((()=>{var t;return null==(t=e.staticElms)?void 0:t.simplebar})),d=u((()=>{var t,i;if(null==(t=e.staticElms)?void 0:t.simplebar)return null==(i=e.staticElms)?void 0:i.scrollbar.getInstance()})),{btnToggle:v,isActive:p,isPinned:h,scrollPin:m,handleClickOutside:k,throttleClick:b}=y(i,n),{scrollPinMobile:w}=C(i,n,l),{scrollPinStatic:S}={scrollPinStatic:(e,t)=>{if(e&&t){const i=o.quickSetter(e,"y","px");t.addListener((e=>{i(e.offset.y)}))}}},E=e=>{let t=0;const i=setInterval((()=>{t>30&&clearInterval(i),e(i),t++}),100)};return c((()=>{t?E((e=>{s.value&&d.value&&(clearInterval(e),S(s.value,d.value))})):g.isDesktop?(g.scrollbar&&m(),document.addEventListener("pointerup",k)):E((e=>{l.value&&(clearInterval(e),w(),f(l.value,(()=>{var e;null==(e=r.getById("filter-pin"))||e.refresh()})))}))})),{root:i,pinContainer:n,btnToggle:v,isActive:p,isPinned:h,throttleClick:b,scrollPin:m,handleClickOutside:k,scrollPinMobile:w}}});const E={key:1,class:"filter__icon"},P=i("svg",{viewBox:"0 0 14 12",width:"14",height:"12"},[i("path",{d:"M.938.5L7 11 13.062.5H.938z"})],-1),x=i("span",{class:"icon-text"},"filter",-1),A={class:"filter__group"},L=i("legend",{class:"visually-hidden"},"Фильтр статей",-1);S.render=function(n,a,l,r,o,s){const u=d("filter-item");return e(),t("div",{ref:"pinContainer",class:[{"is-active":n.isPinned&&n.isActive},"pin-filter-container"]},[i("div",{ref:"root",class:[{"is-pinned":n.isPinned,"is-active":n.isPinned&&n.isActive},"filter"]},[n.isStatic?v("",!0):(e(),t("button",{key:0,ref:"btnToggle",onClick:a[1]||(a[1]=(...e)=>n.throttleClick&&n.throttleClick(...e)),class:"filter__collapse",type:"button"}," Переключить видимость фильтра ",512)),n.isStatic?v("",!0):(e(),t("div",E,[P,x])),i("fieldset",A,[L,(e(!0),t(p,null,h(n.filterItems,(i=>(e(),t(u,{key:i.type,value:i.value,text:i.name,checked:i.checked,handleChange:n.setActiveFilter,name:n.filterName},null,8,["value","text","checked","handleChange","name"])))),128))])],2)],2)};var _="/images/sprite.symbol.svg";export{_,S as a};
